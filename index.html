<html>
<head>
<link rel="stylesheet" href="style.css">

</head>

<body>
<table cellspacing="0" class="chessBoard">
<tr><!--8-->
    <th class="lightSquare" id="a8" ondrop="drop(event)" ondragover="allowDrop(event)" >
        <img  id="br1" src="piecespng/br.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
        
    </th>
    
    <th class="darkSquare" id="b8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bkn1" src="piecespng/bkn.png"draggable="true" ondragstart="drag(event)" class = "chessPiece" >
    </th>
    <th class="lightSquare" id="c8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bb1" src="piecespng/bb.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="d8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bq1" src="piecespng/bq.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="e8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bk1" src="piecespng/bk.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="f8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bb2" src="piecespng/bb.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="g8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bkn2" src="piecespng/bkn.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="h8" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="br2" src="piecespng/br.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
</tr>
<tr><!--7-->
    <th class="darkSquare" id="a7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp1" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="b7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp2" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="c7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp3" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="d7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp4" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="e7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp5" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="f7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp6" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="g7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp7" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="h7" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="bp8" src="piecespng/bp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
</tr>
<tr><!--6-->
    <th class="lightSquare"  id="a6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare"  id="b6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="c6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="d6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="e6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="f6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="g6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="h6" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
</tr>
<tr> <!--5-->
    <th class="darkSquare"  id="a5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="b5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="c5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="d5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="e5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="f5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="g5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare"  id="h5" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
</tr>
<tr><!--4-->
    <th class="lightSquare"  id="a4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare"  id="b4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="c4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="d4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="e4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="f4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="g4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="h4" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
</tr>
<tr><!--3-->
    <th class="darkSquare"  id="a3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="b3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="c3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="d3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="e3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare" id="f3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="darkSquare" id="g3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
    <th class="lightSquare"  id="h3" ondrop="drop(event)" ondragover="allowDrop(event)"></th>
    </th>
</tr>
<tr><!--2-->
    <th class="lightSquare" id="a2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp1" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="b2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp2" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="c2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp3" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="d2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp4" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="e2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp5" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="f2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp6" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="g2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp7" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="h2" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wp8" src="piecespng/wp.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
</tr>
<tr><!--1-->
    <th class="darkSquare" id="a1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wr1" src="piecespng/wr.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="b1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wkn1" src="piecespng/wkn.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="c1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wb1" src="piecespng/wb.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="d1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wq1" src="piecespng/wq.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="e1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wk1" src="piecespng/wk.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="f1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wb2" src="piecespng/wb.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="darkSquare" id="g1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wkn2" src="piecespng/wkn.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
    <th class="lightSquare" id="h1" ondrop="drop(event)" ondragover="allowDrop(event)">
        <img id="wr2" src="piecespng/wr.png"draggable="true" ondragstart="drag(event)" class = "chessPiece">
    </th>
</tr>
</table>
<div>
<p id="pgnList" class="pgnBox"><br>PGN: <br><br></p>    
</div>

<table id="openingTable" class="openingBox" cellspacing = "0" cellpadding = "0">
    <tr id="header">
    <th>ECO</th>
    <th>Name</th>
    <th>PGN</th>
    </tr>
    
</table>

<table id="tableLabelAH" class="tableLabelAH" cellspacing = "0" cellpadding = "0">
<tr> <!--TableLabeling A-H -->
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    </tr>
</table>
<table id="tableLabel18" class="tableLabel18" cellspacing = "0" cellpadding = "0">
    
        <tr><th>8</th></tr>
        <tr><th>7</th></tr>
        <tr><th>6</th></tr>
        <tr><th>5</th></tr>
        <tr><th>4</th></tr>
        <tr><th>3</th></tr>
        <tr><th>2</th></tr>
        <tr><th>1</th></tr>
        
</table>


<div>
<table class="gamesDBBox" cellspacing = "0" cellpadding = "0">
    <tr><th colspan="2">LiChess Elite Games DataBase (Jan-Nov 2022)</th><th id="loadSignal">Loading...</th></tr>
    <tr>
    <th id="online"><br><br><br>Database Local<br>Server<br><br><br>OFFLINE<br></th>
    <th id="dbECO"><br><br><br>ECO<br><br><br><br></th>
    <th id ="numOfGames"><br><br><br>Num of Games:<br><br><br></th>
    </tr>
</tr>
<tr>
    <th id="whiteWins"><br>White Wins:<br><br><br></th>
    <th id="draw"><br>Draw:<br><br><br></th>
    <th id="blackWins"><br>Black Wins:<br><br><br></th>
</tr>


</table>  
</div>

<script>

const observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    const data = { 
      value: document.getElementById("dbECO").innerHTML.substr(-3) 
    };

    fetch("http://localhost:3000/update", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
      .then(res => res.json())
      .then(data => {
        
        
        
        document.getElementById("numOfGames").innerHTML = "";
        document.getElementById("numOfGames").innerHTML += "<br><br><br>Num of Games:<br><br><br>" 
        document.getElementById("numOfGames").innerHTML += data.gamesCount;
        


        document.getElementById("whiteWins").innerHTML = "";
        document.getElementById("whiteWins").innerHTML += "<br>White Wins:<br><br><br>";
        document.getElementById("whiteWins").innerHTML += data.winCount
        let percentageW = (data.winCount/data.gamesCount)*100
        percentageW = Number(Math.round(percentageW+'e2')+'e-2')
        document.getElementById("whiteWins").innerHTML +="<br><br>" + percentageW + "%";




        document.getElementById("draw").innerHTML = "";
        document.getElementById("draw").innerHTML += "<br>Draw:<br><br><br>";
        document.getElementById("draw").innerHTML += data.drawCount
        let percentageD = (data.drawCount/data.gamesCount)*100
        percentageD = Number(Math.round(percentageD+'e2')+'e-2')
        document.getElementById("draw").innerHTML +="<br><br>" + percentageD + "%";

        document.getElementById("blackWins").innerHTML = "";
        document.getElementById("blackWins").innerHTML += "<br>Black Wins:<br><br><br> ";
        document.getElementById("blackWins").innerHTML += data.lossCount
        let percentageB = (data.lossCount/data.gamesCount)*100
        percentageB = Number(Math.round(percentageB+'e2')+'e-2')
        document.getElementById("blackWins").innerHTML +="<br><br>" + percentageB + "%";
       
        document.getElementById("loadSignal").innerHTML ="";
      }
      
      )
      .catch(error => console.error(error));
  });    
});

const targetNode = document.getElementById("dbECO");
observer.observe(targetNode, {
  childList: true,
  subtree: true,
  characterData: true
});
  //document.getElementById("dbECO").innerHTML += "A00"    

  
</script>




<script>
fetch("http://localhost:3000/", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  }
})
  .then(res => res.json())
  .then(data => {
    document.getElementById("online").innerHTML= " ";
    document.getElementById("online").innerHTML +="<br><br><br>Database Local<br>Server<br><br><br>ONLINE<br>"
    
    document.getElementById("numOfGames").innerHTML += data.dbTotal


    document.getElementById("whiteWins").innerHTML += data.dbTotalWin
        let percentageW = (data.dbTotalWin/data.dbTotal)*100
        percentageW = Number(Math.round(percentageW+'e2')+'e-2')
        document.getElementById("whiteWins").innerHTML +="<br><br>" + percentageW + "%";

    document.getElementById("draw").innerHTML += data.dbTotalDraw
        let percentageD = (data.dbTotalDraw/data.dbTotal)*100
        percentageD = Number(Math.round(percentageD+'e2')+'e-2')
        document.getElementById("draw").innerHTML +="<br><br>" + percentageD + "%";

    document.getElementById("blackWins").innerHTML += data.dbTotalLoss
        let percentageB = (data.dbTotalWin/data.dbTotal)*100
        percentageB = Number(Math.round(percentageB+'e2')+'e-2')
        document.getElementById("blackWins").innerHTML +="<br><br>" + percentageB + "%";
    
        document.getElementById("loadSignal").innerHTML ="";
  })
  .catch(error => console.error(error));
</script>


<script src="moves.js"></script>
<script src="openingtable.js"></script>







</body>



</html>